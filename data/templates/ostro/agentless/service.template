{ } .
{include} 'agentless/macros.inc'

{CHECK-MANIFEST}({MANIFEST})
##############################################################################
# This is an automatically generated systemd service file. It is over-
# written upon each boot and each time systemd executes a 'daemon-reload'
# command. Any hand-made changes to this file will be irrecoverably lost.
# for {data.manifest.application} of provider {data.provider}.
#
# Generated for '{APPLICATION.name}' provided by '{APPLICATION.origin}'.
#
# Generated by {TEMPLATE.generator}.
#   - template used: {TEMPLATE.template}
#   - manifest file: {TEMPLATE.manifest}
#

[Unit]
SourcePath={TEMPLATE.manifest}
Description={APPLICATION.description}
{CHECK-FIREWALL}({CONTAINER})

[Service]
{switch} ({CONTAINER.type}) {in}
{case} 'nspawn-app'    {do}{include} 'agentless/nspawn-app.inc'    {end}
{case} 'nspawn-shared' {do}{include} 'agentless/nspawn-shared.inc' {end}
{case} 'nspawn-system' {do}{include} 'agentless/nspawn-system.inc' {end}
{else} {do}
.          {if} (!{CONTAINER.type} || {CONTAINER.type} == 'none') {then}
.                          {include} 'agentless/no-container.inc'
.          {else}
.              {ERROR}(1, 'invalid container type:', {CONTAINER.type})
.          {end}
.      {end}
{end}{\n}

[Install]
WantedBy=applications.target
{CHECK-AUTOSTART}({SERVICE})
